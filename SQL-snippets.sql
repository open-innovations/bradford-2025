-- create a table from a string separated list
CREATE TABLE event_ids AS
SELECT regexp_split_to_table('64601AHJJJGRPPGBJRDJBKDBVLLBQMRLP 64801AJPTMMJGDJQHDKQNBCGKMVGLSGLB 65001ABJBLQTSTGTMVKPRRHSLPSVNVDBM 65201ACRNVHVJBDMGRPJPBKVMQHKPTNJN 65401ARRMBSGBRKRMPJDLPDLGHVCMRJJP 65002ASPDRDSNLPMSGLJDNVNGKQNNJKJM 65601ABJVQCQRNKJTHQGGNGBHPDGVBKKD 64602AQLNMGNSJPNDHMTVGPDNVRRJDRCV 65801ABDQQTPTQHTDJVCCJNHQLNRJJCBG 65202AGSSSKQLRKGHGMLHSDNNNSRKSGQN 64603AQQJBRKGRBTKNDCCTRVBBLMKSGPC 65203ARKDJGBKLPGTVQKHQGMLSCSVVCMS 66001AJSDDCKQDHCCKMMQLSPQJHHDNNSR 65802ATSHJMDCBCNQSPMPBSCBGMTRCNKL 65803ACDRLMMRHGGPGVKPCJPKQJNMDTMQ 66201ANBJCCNMNTBQVCLNSBCLHRLCHCHL 66401ABGHVCPGPCLVNGNMHHVHCCMPBDSP 66601AGQCGDBVSBRBPDBPSKRTDHMKTVRL 66002AMJRRKMLMKQRPHRPCNVGRCJTPPSC 66801AQKPRHKKGQQBTMBVQVVTVMKKQTGN 67001APKGPVRDVBKMDCRCRMPHDNRDBKDN 67201AVCRKQDBSGLQHRCLJQTBDLCTLNNQ 67401ALTRTTRTPTSQHLNNDTGHMDRBCNBR 64604ARKDSJQGBNLTJQLVLJCNNNGSJJJL 66602AKVTPDMRQBBTMRQMJTBNHPPKRKMJ 67601AVHPCSTMMBKTGKLCGLQQCGMMBVSK 66802ALTBGLDQGCMRJNMSJMTRHHLCHHCQ 66402AQSGKVVNKGTGDDCQQRVHVTCPGDRN 67602AGRNQSGNGVNNJGBCCMVRNLPVLHRN 67801ATCLBJSLNJHDDQMPHBVVCKNGLMHB 69201ARPJLTNJBTLLMTLRNMQHNSVKNBHM 69801ACHMQQPHNNNRPKGGCKPVPDJPPBTJ 70001AMJRQHDGBRNVCKLMQDNCHKHNLGPL 70201ADHVPVLHCVCVCTRPRPPPJCCSKTGL 69802AGMDGRMVVMRNBNDDRDCLTQTNLCBH 70401ASVSQQQCRPSCNRQPCKDQQQTGLMGK 70601ARTMQVDQNBCQNBNVCVCNCQVKTRPG 69402ARHVPHVRBNRRQVBCNDVGQPGBVNLQ 69403ADGLQNJBMTSRBPBGTHMDGNDCCSCL 70801ACCPCJTVQVGBDPKMJGLRTJJDDVBG 71001AGBBMCNTJHLGBJRQPPQJJCSTSQBR 65803ACDRLMMRHGGPGVKPCJPKQJNMDTMQ 66801AQKPRHKKGQQBTMBVQVVTVMKKQTGN', ' ') AS event_id;

-- join this list with the event instances data file
CREATE TABLE csl as
SELECT event_name, e.event_id, instance_id
FROM event_ids as e
JOIN (
    SELECT event_id, event_name, instance_id FROM 'data/published/ticketing/event-instances.csv'
) as i
ON e.event_id == i.event_id;

-- convert column to a space separated list
select array_to_string(list(instance_id), ' ') as ids from csl;